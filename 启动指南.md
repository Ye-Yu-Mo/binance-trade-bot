# Binance Trade Bot å¯åŠ¨æŒ‡å—

## é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäºå¸å®‰(Binance)äº¤æ˜“æ‰€çš„è‡ªåŠ¨åŒ–åŠ å¯†è´§å¸äº¤æ˜“æœºå™¨äººï¼Œæ”¯æŒï¼š
- å¤šå¸ç§è‡ªåŠ¨å¥—åˆ©äº¤æ˜“
- å†å²æ•°æ®å›æµ‹
- å¤šç§äº¤æ˜“ç­–ç•¥
- REST API å’Œ WebSocket å®æ—¶ç›‘æ§

---

## ä¸€ã€ç¯å¢ƒè¦æ±‚

### ç³»ç»Ÿè¦æ±‚
- Python 3.8.11 æˆ–æ›´é«˜ç‰ˆæœ¬
- SQLite 3.x
- ç¨³å®šçš„ç½‘ç»œè¿æ¥ï¼ˆè®¿é—®å¸å®‰APIï¼‰

### è´¦æˆ·è¦æ±‚
- å¸å®‰è´¦æˆ·ï¼ˆéœ€è¦é€šè¿‡KYCè®¤è¯ï¼‰
- APIå¯†é’¥ï¼ˆéœ€è¦å¼€å¯ç°è´§äº¤æ˜“æƒé™ï¼‰

---

## äºŒã€å®‰è£…æ­¥éª¤

### 1. å…‹éš†é¡¹ç›®ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
```bash
cd /Users/jasxu/Documents/crypto
# å¦‚æœå·²ç»æœ‰é¡¹ç›®ï¼Œè·³è¿‡è¿™æ­¥
```

### 2. å®‰è£…Pythonä¾èµ–
```bash
cd /Users/jasxu/Documents/crypto/binance-trade-bot
pip install -r requirements.txt
```

ä¾èµ–åŒ…åˆ—è¡¨ï¼š
- python-binance==1.0.27  # å¸å®‰APIå®¢æˆ·ç«¯
- sqlalchemy==1.4.15      # æ•°æ®åº“ORM
- schedule==1.1.0         # ä»»åŠ¡è°ƒåº¦
- apprise==0.9.5.1        # é€šçŸ¥ç³»ç»Ÿ
- Flask==2.3.2            # Web API
- gunicorn==20.1.0        # ç”Ÿäº§æœåŠ¡å™¨
- flask-cors==3.0.10      # è·¨åŸŸæ”¯æŒ
- flask-socketio==5.0.1   # WebSocket
- eventlet==0.30.2        # å¼‚æ­¥ç½‘ç»œåº“
- cachetools==4.2.2       # ç¼“å­˜å·¥å…·
- sqlitedict==1.7.0       # å›æµ‹ç¼“å­˜
- unicorn-binance-websocket-api==1.34.2  # WebSocketå®¢æˆ·ç«¯

---

## ä¸‰ã€é…ç½®æ–‡ä»¶è®¾ç½®

### 1. åˆ›å»ºç”¨æˆ·é…ç½®æ–‡ä»¶

**ä½ç½®ï¼š** `/Users/jasxu/Documents/crypto/binance-trade-bot/user.cfg`

**åˆ›å»ºæ–¹æ³•ï¼š**
```bash
cd /Users/jasxu/Documents/crypto/binance-trade-bot
cp .user.cfg.example user.cfg
```

### 2. è·å–å¸å®‰APIå¯†é’¥

**æ­¥éª¤ï¼š**
1. ç™»å½•å¸å®‰å®˜ç½‘ https://www.binance.com
2. è¿›å…¥ã€Œä¸ªäººä¸­å¿ƒã€â†’ã€ŒAPIç®¡ç†ã€
3. åˆ›å»ºæ–°çš„APIå¯†é’¥
4. **é‡è¦å®‰å…¨è®¾ç½®ï¼š**
   - âœ… å¯ç”¨ã€Œç°è´§åŠæ æ†äº¤æ˜“ã€æƒé™
   - âŒ ç¦ç”¨ã€Œæå¸ã€æƒé™ï¼ˆé˜²æ­¢è¢«ç›—ï¼‰
   - ç»‘å®šIPç™½åå•ï¼ˆå¯é€‰ä½†å¼ºçƒˆæ¨èï¼‰
5. ä¿å­˜ API Key å’Œ Secret Key

### 3. ç¼–è¾‘é…ç½®æ–‡ä»¶

æ‰“å¼€ `user.cfg` æ–‡ä»¶è¿›è¡Œç¼–è¾‘ï¼š

```ini
[binance_user_config]

# ========== APIé…ç½® ==========
# æ›¿æ¢ä¸ºä½ çš„çœŸå®APIå¯†é’¥
api_key=ä½ çš„API_KEY
api_secret_key=ä½ çš„SECRET_KEY

# æ˜¯å¦ä½¿ç”¨æµ‹è¯•ç½‘ï¼ˆå»ºè®®å…ˆç”¨æµ‹è¯•ç½‘ç»ƒä¹ ï¼‰
# true=æµ‹è¯•ç½‘ï¼ˆè™šæ‹Ÿèµ„é‡‘ï¼‰, false=ä¸»ç½‘ï¼ˆçœŸå®èµ„é‡‘ï¼‰
testnet=false

# å¸å®‰åœ°åŸŸè®¾ç½®
# com=å›½é™…ç‰ˆ, us=ç¾å›½ç‰ˆ
tld=com

# ========== äº¤æ˜“é…ç½® ==========
# åˆå§‹å¸ç§ï¼ˆå¿…é¡»åœ¨ supported_coin_list æ–‡ä»¶ä¸­ï¼‰
# ç•™ç©ºåˆ™ä½¿ç”¨æ¡¥æ¥å¸ï¼ˆæ¨èæ–°æ‰‹ç•™ç©ºï¼‰
current_coin=

# æ¡¥æ¥å¸ç§ï¼ˆç”¨äºä¸­è½¬çš„ç¨³å®šå¸ï¼‰
# æ¨èï¼šUSDT, BUSD, USDC
bridge=USDT

# ========== ç­–ç•¥é…ç½® ==========
# é¢„é…ç½®ç­–ç•¥ï¼šdefaultï¼ˆé»˜è®¤ï¼‰æˆ– multiple_coinsï¼ˆå¤šå¸ç§ï¼‰
strategy=default

# ä½¿ç”¨å“ªç§è®¡ç®—æ–¹å¼
# yes=ä½¿ç”¨scout_marginï¼ˆåˆ©æ¶¦ç™¾åˆ†æ¯”ï¼‰
# no=ä½¿ç”¨scout_multiplierï¼ˆä»·æ ¼å€æ•°ï¼‰
use_margin=no

# ä»·æ ¼å€æ•°ï¼ˆuse_margin=noæ—¶ç”Ÿæ•ˆï¼‰
# æ¨èå€¼ï¼š3-7ä¹‹é—´ï¼Œè¶Šå¤§è¶Šä¿å®ˆ
scout_multiplier=5

# åˆ©æ¶¦ç™¾åˆ†æ¯”ï¼ˆuse_margin=yesæ—¶ç”Ÿæ•ˆï¼‰
# æ¨èå€¼ï¼š0.3-1.2ä¹‹é—´ï¼Œè¡¨ç¤ºæœ€å°åˆ©æ¶¦ç‡
scout_margin=0.8

# æ‰«æé—´éš”ï¼ˆç§’ï¼‰
# æ¯éš”å¤šå°‘ç§’æ£€æŸ¥ä¸€æ¬¡ä»·æ ¼ï¼Œæ¨è1-5ç§’
scout_sleep_time=1

# ========== è®¢å•è¶…æ—¶ ==========
# ä¹°å•/å–å•è¶…æ—¶æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
# 0è¡¨ç¤ºæ°¸ä¸è¶…æ—¶ï¼Œæ¨è20åˆ†é’Ÿ
buy_timeout=20
sell_timeout=20

# ========== å†å²æ•°æ® ==========
# ä¾¦å¯Ÿå†å²ä¿ç•™æ—¶é•¿ï¼ˆå°æ—¶ï¼‰
# ç”¨äºæ¸…ç†æ•°æ®åº“ï¼Œé¿å…å ç”¨è¿‡å¤šç©ºé—´
hourToKeepScoutHistory=1
```

### 4. é…ç½®æ”¯æŒçš„å¸ç§åˆ—è¡¨

**ä½ç½®ï¼š** `/Users/jasxu/Documents/crypto/binance-trade-bot/supported_coin_list`

**å½“å‰æ”¯æŒçš„å¸ç§ï¼š**
```
ADA
ATOM
BAT
BTTC
DASH
DOGE      â† åŒ…å«ç‹—ç‹—å¸
EOS
ETC
ICX
IOTA
NEO
OMG
ONT
QTUM
TRX
VET
XLM
XMR
```

**ä¿®æ”¹æ–¹æ³•ï¼š**
- ç›´æ¥ç¼–è¾‘æ­¤æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªå¸ç§ç¬¦å·ï¼ˆä¸åŒ…å«USDTåç¼€ï¼‰
- å¯ä»¥æ·»åŠ æˆ–åˆ é™¤å¸ç§
- **æ³¨æ„ï¼š** æ‰€æœ‰å¸ç§å¿…é¡»åœ¨å¸å®‰æœ‰å¯¹åº”çš„äº¤æ˜“å¯¹ï¼ˆå¦‚ DOGEUSDTï¼‰

### 5. é…ç½®é€šçŸ¥ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦äº¤æ˜“é€šçŸ¥ï¼ˆTelegramã€Discordç­‰ï¼‰ï¼š

**ä½ç½®ï¼š** `/Users/jasxu/Documents/crypto/binance-trade-bot/config/apprise.yml`

**ç¤ºä¾‹é…ç½®ï¼š**
```yaml
# Telegramé€šçŸ¥
tgram://bottoken/ChatID

# Discordé€šçŸ¥
discord://WebhookID/WebhookToken
```

å‚è€ƒå®˜æ–¹æ–‡æ¡£é…ç½®æ›´å¤šé€šçŸ¥æ–¹å¼ã€‚

---

## å››ã€å¯åŠ¨é¡¹ç›®

### æ–¹å¼1ï¼šç›´æ¥è¿è¡Œï¼ˆæ¨èæµ‹è¯•ï¼‰

#### å¯åŠ¨äº¤æ˜“æœºå™¨äºº
```bash
cd /Users/jasxu/Documents/crypto/binance-trade-bot
python -m binance_trade_bot
```

**é¢„æœŸè¾“å‡ºï¼š**
```
INFO - Successfully got exchange info
INFO - Initializing database...
INFO - Initialization complete!
INFO - I am scouting the best trades. Current coin: DOGEUSDT
```

#### å¯åŠ¨APIæœåŠ¡ï¼ˆå¯é€‰ï¼‰
åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£è¿è¡Œï¼š
```bash
python -m binance_trade_bot.api_server
```

è®¿é—® http://localhost:5123 æŸ¥çœ‹Webç•Œé¢

### æ–¹å¼2ï¼šDockeréƒ¨ç½²ï¼ˆæ¨èç”Ÿäº§ï¼‰

```bash
cd /Users/jasxu/Documents/crypto/binance-trade-bot

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f crypto-trading

# åœæ­¢æœåŠ¡
docker-compose down
```

**DockeræœåŠ¡åŒ…å«ï¼š**
- `crypto-trading`: ä¸»äº¤æ˜“æœºå™¨äºº
- `api`: REST APIæœåŠ¡ï¼ˆç«¯å£5123ï¼‰
- `sqlitebrowser`: æ•°æ®åº“å¯è§†åŒ–å·¥å…·ï¼ˆç«¯å£3000ï¼‰

---

## äº”ã€å›æµ‹åŠŸèƒ½

### 1. DOGEUSDT ä¸€å¹´å›æµ‹

#### æ–¹æ³•Aï¼šä½¿ç”¨é»˜è®¤å›æµ‹è„šæœ¬

**ç¼–è¾‘å›æµ‹è„šæœ¬ï¼š** `/Users/jasxu/Documents/crypto/binance-trade-bot/backtest.py`

```python
from datetime import datetime, timedelta
from binance_trade_bot import backtest

if __name__ == "__main__":
    # è®¾ç½®å›æµ‹æ—¶é—´èŒƒå›´ï¼ˆæœ€è¿‘ä¸€å¹´ï¼‰
    end_date = datetime.now()
    start_date = end_date - timedelta(days=365)

    print(f"å¼€å§‹å›æµ‹ï¼š{start_date} è‡³ {end_date}")
    print("=" * 60)

    history = []
    for manager in backtest(start_date, end_date):
        btc_value = manager.collate_coins("BTC")
        bridge_value = manager.collate_coins(manager.config.BRIDGE.symbol)
        history.append((btc_value, bridge_value))

        # è®¡ç®—æ”¶ç›Šç‡
        btc_diff = round((btc_value - history[0][0]) / history[0][0] * 100, 3)
        bridge_diff = round((bridge_value - history[0][1]) / history[0][1] * 100, 3)

        print("------")
        print("æ—¶é—´:", manager.datetime)
        print("æŒä»“:", manager.balances)
        print("BTCä»·å€¼:", btc_value, f"({btc_diff}%)")
        print(f"{manager.config.BRIDGE.symbol}ä»·å€¼:", bridge_value, f"({bridge_diff}%)")
        print("------")
```

**è¿è¡Œå›æµ‹ï¼š**
```bash
cd /Users/jasxu/Documents/crypto/binance-trade-bot
python backtest.py
```

#### æ–¹æ³•Bï¼šè‡ªå®šä¹‰å›æµ‹ä»£ç 

åˆ›å»ºæ–°æ–‡ä»¶ `backtest_doge.py`ï¼š

```python
from datetime import datetime, timedelta
from binance_trade_bot import backtest
from binance_trade_bot.config import Config

if __name__ == "__main__":
    # è‡ªå®šä¹‰é…ç½®
    config = Config()

    # ç¡®ä¿DOGEåœ¨æ”¯æŒåˆ—è¡¨ä¸­
    if 'DOGE' not in config.SUPPORTED_COIN_LIST:
        print("è­¦å‘Š: DOGEä¸åœ¨æ”¯æŒåˆ—è¡¨ä¸­ï¼Œæ·»åŠ ä¸­...")
        config.SUPPORTED_COIN_LIST.append('DOGE')

    # è®¾ç½®ä¸ºDOGEä½œä¸ºåˆå§‹å¸ç§
    config.CURRENT_COIN_SYMBOL = 'DOGE'

    # å›æµ‹æœ€è¿‘ä¸€å¹´
    end_date = datetime.now()
    start_date = end_date - timedelta(days=365)

    print(f"å¼€å§‹DOGEUSDTå›æµ‹")
    print(f"æ—¶é—´èŒƒå›´: {start_date.date()} è‡³ {end_date.date()}")
    print(f"æ¡¥æ¥å¸: {config.BRIDGE.symbol}")
    print(f"ç­–ç•¥: {config.STRATEGY}")
    print("=" * 60)

    history = []
    trade_count = 0

    for manager in backtest(start_date, end_date, config=config):
        # ç»Ÿè®¡äº¤æ˜“æ¬¡æ•°
        if len(history) > 0:
            if manager.balances != history[-1][2]:
                trade_count += 1

        btc_value = manager.collate_coins("BTC")
        usdt_value = manager.collate_coins(config.BRIDGE.symbol)
        history.append((btc_value, usdt_value, manager.balances.copy()))

        # æ¯100æ¬¡è¿­ä»£æ‰“å°ä¸€æ¬¡
        if len(history) % 100 == 0:
            btc_diff = round((btc_value - history[0][0]) / history[0][0] * 100, 2)
            usdt_diff = round((usdt_value - history[0][1]) / history[0][1] * 100, 2)

            print(f"[{manager.datetime}] "
                  f"BTC: {btc_value:.8f} ({btc_diff:+.2f}%) | "
                  f"USDT: {usdt_value:.2f} ({usdt_diff:+.2f}%) | "
                  f"äº¤æ˜“æ¬¡æ•°: {trade_count}")

    # æœ€ç»ˆæŠ¥å‘Š
    print("\n" + "=" * 60)
    print("å›æµ‹å®Œæˆï¼æœ€ç»ˆæŠ¥å‘Šï¼š")
    print("=" * 60)
    final_btc = history[-1][0]
    final_usdt = history[-1][1]
    initial_btc = history[0][0]
    initial_usdt = history[0][1]

    btc_return = (final_btc - initial_btc) / initial_btc * 100
    usdt_return = (final_usdt - initial_usdt) / initial_usdt * 100

    print(f"æ€»äº¤æ˜“æ¬¡æ•°: {trade_count}")
    print(f"BTCæ”¶ç›Šç‡: {btc_return:+.2f}%")
    print(f"USDTæ”¶ç›Šç‡: {usdt_return:+.2f}%")
    print(f"åˆå§‹BTCä»·å€¼: {initial_btc:.8f} â†’ æœ€ç»ˆ: {final_btc:.8f}")
    print(f"åˆå§‹USDTä»·å€¼: {initial_usdt:.2f} â†’ æœ€ç»ˆ: {final_usdt:.2f}")
```

**è¿è¡Œï¼š**
```bash
python backtest_doge.py
```

### 2. å›æµ‹æ³¨æ„äº‹é¡¹

**ä¼˜ç‚¹ï¼š**
- âœ… ä½¿ç”¨çœŸå®å†å²Kçº¿æ•°æ®
- âœ… æœ¬åœ°ç¼“å­˜æœºåˆ¶ï¼ˆé¿å…é‡å¤APIè¯·æ±‚ï¼‰
- âœ… æ”¯æŒè‡ªå®šä¹‰æ—¶é—´èŒƒå›´

**é™åˆ¶ï¼š**
- âš ï¸ å¸å®‰APIé™åˆ¶ï¼šæ¯åˆ†é’Ÿæœ€å¤š1200æ¬¡è¯·æ±‚
- âš ï¸ å†å²æ•°æ®ä¾èµ–ç½‘ç»œï¼ˆé¦–æ¬¡è¿è¡Œè¾ƒæ…¢ï¼‰
- âš ï¸ ä¸åŒ…å«çœŸå®äº¤æ˜“çš„æ»‘ç‚¹å’Œæ‰‹ç»­è´¹
- âš ï¸ å›æµ‹ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸ä»£è¡¨å®ç›˜è¡¨ç°

**ç¼“å­˜ä½ç½®ï¼š**
`/Users/jasxu/Documents/crypto/binance-trade-bot/data/backtest_cache.db`

### 3. æŸ¥çœ‹å›æµ‹æ•°æ®

å›æµ‹æœŸé—´ä¼šç”ŸæˆSQLiteæ•°æ®åº“ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·æŸ¥çœ‹ï¼š

**å‘½ä»¤è¡ŒæŸ¥è¯¢ï¼š**
```bash
sqlite3 data/crypto_trading.db
```

**SQLç¤ºä¾‹æŸ¥è¯¢ï¼š**
```sql
-- æŸ¥çœ‹æ‰€æœ‰äº¤æ˜“å†å²
SELECT * FROM trade_history ORDER BY datetime DESC LIMIT 10;

-- æŸ¥çœ‹å¸å€¼å˜åŒ–
SELECT * FROM coin_value ORDER BY datetime DESC;

-- æŸ¥çœ‹ä¾¦å¯Ÿå†å²
SELECT * FROM scout_history;
```

**å›¾å½¢åŒ–å·¥å…·ï¼š**
- DB Browser for SQLiteï¼ˆæ¨èï¼‰
- DBeaver
- Dockeré•œåƒï¼š`sqlitebrowser`ï¼ˆç«¯å£3000ï¼‰

---

## å…­ã€ç­–ç•¥å¼€å‘

### 1. ç­–ç•¥ç³»ç»Ÿæ¶æ„

æ‰€æœ‰ç­–ç•¥éƒ½ç»§æ‰¿è‡ª `AutoTrader` åŸºç±»ï¼Œæ ¸å¿ƒæ–¹æ³•æ˜¯ `scout()`ã€‚

### 2. åˆ›å»ºè‡ªå®šä¹‰ç­–ç•¥

#### æ­¥éª¤1ï¼šåˆ›å»ºç­–ç•¥æ–‡ä»¶

**ä½ç½®ï¼š** `/Users/jasxu/Documents/crypto/binance-trade-bot/binance_trade_bot/strategies/my_custom_strategy.py`

**åŸºç¡€æ¨¡æ¿ï¼š**
```python
from binance_trade_bot.auto_trader import AutoTrader

class Strategy(AutoTrader):
    """
    è‡ªå®šä¹‰äº¤æ˜“ç­–ç•¥ç¤ºä¾‹
    """

    def initialize(self):
        """
        ç­–ç•¥åˆå§‹åŒ–ï¼ˆå¯é€‰ï¼‰
        åœ¨ç­–ç•¥å¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡
        """
        super().initialize()
        # ä½ çš„åˆå§‹åŒ–ä»£ç 
        self.logger.info("è‡ªå®šä¹‰ç­–ç•¥å·²åŠ è½½")

    def scout(self):
        """
        æ ¸å¿ƒä¾¦å¯Ÿæ–¹æ³•ï¼ˆå¿…é¡»å®ç°ï¼‰
        ç”±è°ƒåº¦å™¨å®šæœŸè°ƒç”¨ï¼ˆé»˜è®¤æ¯5ç§’ï¼‰
        """
        # è·å–å½“å‰æŒæœ‰çš„å¸ç§
        current_coin = self.db.get_current_coin()

        # è·å–å½“å‰ä»·æ ¼
        current_price = self.manager.get_ticker_price(
            current_coin + self.config.BRIDGE
        )

        if current_price is None:
            self.logger.warning(f"æ— æ³•è·å–{current_coin}ä»·æ ¼")
            return

        # ä½ çš„äº¤æ˜“é€»è¾‘
        # ä¾‹å¦‚ï¼šæ‰«ææ‰€æœ‰å¸ç§ï¼Œæ‰¾åˆ°æœ€ä½³äº¤æ˜“å¯¹
        self._jump_to_best_coin(current_coin, current_price)
```

#### æ­¥éª¤2ï¼šé«˜çº§ç­–ç•¥ç¤ºä¾‹

**è¶‹åŠ¿è·Ÿè¸ªç­–ç•¥ï¼š**
```python
from binance_trade_bot.auto_trader import AutoTrader
from datetime import datetime, timedelta

class Strategy(AutoTrader):
    """
    åŸºäºç§»åŠ¨å¹³å‡çº¿çš„è¶‹åŠ¿è·Ÿè¸ªç­–ç•¥
    """

    def initialize(self):
        super().initialize()
        self.short_window = 10  # çŸ­æœŸå‡çº¿çª—å£
        self.long_window = 30   # é•¿æœŸå‡çº¿çª—å£
        self.price_history = {}  # å­˜å‚¨ä»·æ ¼å†å²

    def get_moving_average(self, coin_pair, window):
        """
        è®¡ç®—ç§»åŠ¨å¹³å‡çº¿
        """
        if coin_pair not in self.price_history:
            return None

        prices = self.price_history[coin_pair]
        if len(prices) < window:
            return None

        return sum(prices[-window:]) / window

    def update_price_history(self, coin_pair, price):
        """
        æ›´æ–°ä»·æ ¼å†å²
        """
        if coin_pair not in self.price_history:
            self.price_history[coin_pair] = []

        self.price_history[coin_pair].append(price)

        # åªä¿ç•™æœ€è¿‘100ä¸ªä»·æ ¼ç‚¹
        if len(self.price_history[coin_pair]) > 100:
            self.price_history[coin_pair].pop(0)

    def scout(self):
        """
        ä½¿ç”¨åŒå‡çº¿äº¤å‰ç­–ç•¥
        """
        current_coin = self.db.get_current_coin()
        coin_pair = current_coin + self.config.BRIDGE

        # è·å–å½“å‰ä»·æ ¼
        current_price = self.manager.get_ticker_price(coin_pair)
        if current_price is None:
            return

        # æ›´æ–°ä»·æ ¼å†å²
        self.update_price_history(coin_pair, current_price)

        # è®¡ç®—å‡çº¿
        short_ma = self.get_moving_average(coin_pair, self.short_window)
        long_ma = self.get_moving_average(coin_pair, self.long_window)

        if short_ma is None or long_ma is None:
            self.logger.info("æ•°æ®ä¸è¶³ï¼Œç­‰å¾…æ›´å¤šä»·æ ¼æ•°æ®...")
            return

        # é‡‘å‰ä¿¡å·ï¼šçŸ­æœŸå‡çº¿ä¸Šç©¿é•¿æœŸå‡çº¿ï¼ˆä¹°å…¥ä¿¡å·ï¼‰
        if short_ma > long_ma:
            self.logger.info(f"æ£€æµ‹åˆ°é‡‘å‰ä¿¡å·: {coin_pair}")
            # æ‰§è¡Œä½ çš„ä¹°å…¥é€»è¾‘
            self._jump_to_best_coin(current_coin, current_price)

        # æ­»å‰ä¿¡å·ï¼šçŸ­æœŸå‡çº¿ä¸‹ç©¿é•¿æœŸå‡çº¿ï¼ˆå–å‡ºä¿¡å·ï¼‰
        elif short_ma < long_ma:
            self.logger.info(f"æ£€æµ‹åˆ°æ­»å‰ä¿¡å·: {coin_pair}")
            # è¿™é‡Œå¯ä»¥æ·»åŠ å–å‡ºé€»è¾‘
            # æˆ–åˆ‡æ¢åˆ°æ¡¥æ¥å¸
```

**æ³¢åŠ¨ç‡çªç ´ç­–ç•¥ï¼š**
```python
from binance_trade_bot.auto_trader import AutoTrader
import statistics

class Strategy(AutoTrader):
    """
    åŸºäºå¸ƒæ—å¸¦çš„æ³¢åŠ¨ç‡çªç ´ç­–ç•¥
    """

    def initialize(self):
        super().initialize()
        self.window = 20  # å¸ƒæ—å¸¦å‘¨æœŸ
        self.std_multiplier = 2  # æ ‡å‡†å·®å€æ•°
        self.price_cache = {}

    def calculate_bollinger_bands(self, prices):
        """
        è®¡ç®—å¸ƒæ—å¸¦ä¸Šä¸‹è½¨
        """
        if len(prices) < self.window:
            return None, None, None

        recent_prices = prices[-self.window:]
        middle_band = statistics.mean(recent_prices)
        std_dev = statistics.stdev(recent_prices)

        upper_band = middle_band + (std_dev * self.std_multiplier)
        lower_band = middle_band - (std_dev * self.std_multiplier)

        return lower_band, middle_band, upper_band

    def scout(self):
        """
        åœ¨ä»·æ ¼è§¦åŠå¸ƒæ—å¸¦ä¸‹è½¨æ—¶ä¹°å…¥
        åœ¨ä»·æ ¼è§¦åŠä¸Šè½¨æ—¶å–å‡º
        """
        current_coin = self.db.get_current_coin()

        # éå†æ‰€æœ‰æ”¯æŒçš„å¸ç§
        for coin in self.config.SUPPORTED_COIN_LIST:
            coin_pair = coin + self.config.BRIDGE
            price = self.manager.get_ticker_price(coin_pair)

            if price is None:
                continue

            # ç¼“å­˜ä»·æ ¼
            if coin not in self.price_cache:
                self.price_cache[coin] = []
            self.price_cache[coin].append(price)

            # é™åˆ¶ç¼“å­˜å¤§å°
            if len(self.price_cache[coin]) > 100:
                self.price_cache[coin].pop(0)

            # è®¡ç®—å¸ƒæ—å¸¦
            lower, middle, upper = self.calculate_bollinger_bands(
                self.price_cache[coin]
            )

            if lower is None:
                continue

            # çªç ´ä¸‹è½¨ï¼ˆè¶…å–ï¼Œä¹°å…¥ä¿¡å·ï¼‰
            if price <= lower and coin != current_coin.symbol:
                self.logger.info(
                    f"{coin}è§¦åŠå¸ƒæ—å¸¦ä¸‹è½¨ "
                    f"(ä»·æ ¼:{price}, ä¸‹è½¨:{lower:.8f})"
                )
                # æ‰§è¡Œè·³è½¬
                self._jump_to_best_coin(current_coin, price)
                break
```

#### æ­¥éª¤3ï¼šé…ç½®ç­–ç•¥

**åœ¨ `user.cfg` ä¸­æŒ‡å®šç­–ç•¥ï¼š**
```ini
# å¦‚æœæ–‡ä»¶åæ˜¯ my_custom_strategy.py
strategy=my_custom

# å¦‚æœæ–‡ä»¶åæ˜¯ trend_following_strategy.py
strategy=trend_following
```

**ç­–ç•¥å‘½åè§„åˆ™ï¼š**
- æ–‡ä»¶åå¿…é¡»ä»¥ `_strategy.py` ç»“å°¾
- é…ç½®ä¸­çš„åç§°å»æ‰ `_strategy` åç¼€
- ä¾‹å¦‚ï¼š`awesome_strategy.py` â†’ `strategy=awesome`

### 3. å¯ç”¨çš„APIæ–¹æ³•

#### æ•°æ®åº“æ“ä½œï¼ˆself.dbï¼‰
```python
# è·å–å½“å‰æŒå¸
current_coin = self.db.get_current_coin()

# è®¾ç½®å½“å‰æŒå¸
self.db.set_current_coin('DOGE')

# è·å–æ‰€æœ‰å¸ç§
all_coins = self.db.get_coins()

# è®°å½•äº¤æ˜“
self.db.log_scout(pair, target_ratio, current_coin_price)
```

#### APIç®¡ç†å™¨ï¼ˆself.managerï¼‰
```python
# è·å–ä»·æ ¼
price = self.manager.get_ticker_price('DOGEUSDT')

# è·å–ä½™é¢
balance = self.manager.get_currency_balance('DOGE')

# ä¹°å…¥
self.manager.buy_alt(coin, bridge_coin)

# å–å‡º
self.manager.sell_alt(coin, bridge_coin)

# è·å–æœ€å°äº¤æ˜“é¢
min_notional = self.manager.get_min_notional('DOGE', 'USDT')
```

#### é…ç½®è®¿é—®ï¼ˆself.configï¼‰
```python
# æ¡¥æ¥å¸
bridge = self.config.BRIDGE.symbol  # 'USDT'

# æ”¯æŒçš„å¸ç§åˆ—è¡¨
coins = self.config.SUPPORTED_COIN_LIST  # ['ADA', 'DOGE', ...]

# ç­–ç•¥å‚æ•°
multiplier = self.config.SCOUT_MULTIPLIER
margin = self.config.SCOUT_MARGIN
```

#### æ—¥å¿—è®°å½•ï¼ˆself.loggerï¼‰
```python
self.logger.info("ä¿¡æ¯æ—¥å¿—")
self.logger.warning("è­¦å‘Šæ—¥å¿—")
self.logger.error("é”™è¯¯æ—¥å¿—")
```

### 4. ç­–ç•¥æµ‹è¯•æµç¨‹

#### 1. å…ˆåœ¨å›æµ‹ä¸­æµ‹è¯•
```python
# backtest_my_strategy.py
from datetime import datetime, timedelta
from binance_trade_bot import backtest
from binance_trade_bot.config import Config

config = Config()
config.STRATEGY = 'my_custom'  # ä½ çš„ç­–ç•¥å

for manager in backtest(
    datetime(2021, 1, 1),
    datetime.now(),
    config=config
):
    # åˆ†æç»“æœ
    pass
```

#### 2. ä½¿ç”¨æµ‹è¯•ç½‘æµ‹è¯•
```ini
# user.cfg
testnet=true  # ä½¿ç”¨è™šæ‹Ÿèµ„é‡‘
strategy=my_custom
```

#### 3. å°èµ„é‡‘å®ç›˜æµ‹è¯•
```ini
testnet=false
strategy=my_custom
# åªç”¨å°‘é‡èµ„é‡‘æµ‹è¯•
```

### 5. å†…ç½®ç­–ç•¥å¯¹æ¯”

| ç­–ç•¥ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| `default` | å•å¸ç§æŒä»“ï¼Œå¯»æ‰¾æœ€ä½³è·³è½¬æœºä¼š | ç®€å•ç¨³å¥ï¼Œé€‚åˆæ–°æ‰‹ |
| `multiple_coins` | å¤šå¸ç§æŒä»“ï¼Œåˆ†æ•£é£é™© | é¿å…å•å¸å¡ä½ï¼Œæ›´çµæ´» |

### 6. ç­–ç•¥å¼€å‘å»ºè®®

**å®‰å…¨æ€§ï¼š**
- âœ… å§‹ç»ˆæ£€æŸ¥ä»·æ ¼æ˜¯å¦ä¸º None
- âœ… è®¾ç½®æœ€å°äº¤æ˜“é¢æ£€æŸ¥
- âœ… è®°å½•è¯¦ç»†æ—¥å¿—
- âœ… å¤„ç†å¼‚å¸¸æƒ…å†µ

**æ€§èƒ½ï¼š**
- âš ï¸ é¿å…åœ¨ scout() ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ
- âš ï¸ ä½¿ç”¨ç¼“å­˜å‡å°‘APIè°ƒç”¨
- âš ï¸ scout() ä¼šæ¯5ç§’æ‰§è¡Œä¸€æ¬¡

**æµ‹è¯•ï¼š**
- ğŸ“Š å…ˆå›æµ‹ â†’ æµ‹è¯•ç½‘ â†’ å°èµ„é‡‘å®ç›˜
- ğŸ“Š ç›‘æ§è‡³å°‘ä¸€å‘¨å†å¢åŠ èµ„é‡‘
- ğŸ“Š è®°å½•æ‰€æœ‰äº¤æ˜“å†³ç­–

---

## ä¸ƒã€ç›‘æ§å’Œç®¡ç†

### 1. æŸ¥çœ‹æ—¥å¿—

**æ—¥å¿—ä½ç½®ï¼š**
```
/Users/jasxu/Documents/crypto/binance-trade-bot/logs/
```

**å®æ—¶æŸ¥çœ‹ï¼š**
```bash
tail -f logs/crypto_trading.log
```

### 2. æŸ¥çœ‹æ•°æ®åº“

**æ•°æ®åº“ä½ç½®ï¼š**
```
/Users/jasxu/Documents/crypto/binance-trade-bot/data/crypto_trading.db
```

**ä½¿ç”¨SQLiteå‘½ä»¤è¡Œï¼š**
```bash
sqlite3 data/crypto_trading.db

-- æŸ¥çœ‹äº¤æ˜“å†å²
SELECT * FROM trade_history ORDER BY datetime DESC LIMIT 10;

-- æŸ¥çœ‹å½“å‰æŒå¸
SELECT * FROM current_coin;

-- æŸ¥çœ‹æ‰€æœ‰å¸ç§
SELECT * FROM coins WHERE enabled = 1;
```

### 3. Webç•Œé¢ç›‘æ§

å¦‚æœå¯åŠ¨äº†APIæœåŠ¡ï¼š
```bash
python -m binance_trade_bot.api_server
```

è®¿é—®ï¼šhttp://localhost:5123

**APIç«¯ç‚¹ï¼š**
- `/api/current_coin` - å½“å‰æŒå¸
- `/api/trade_history` - äº¤æ˜“å†å²
- `/api/value_history/<coin>` - å¸å€¼å†å²
- `/api/pairs` - å¸å¯¹ä¿¡æ¯

---

## å…«ã€å®‰å…¨å»ºè®®

### 1. APIå®‰å…¨
- âœ… ç»‘å®šIPç™½åå•
- âœ… ç¦ç”¨æå¸æƒé™
- âœ… å®šæœŸæ›´æ¢APIå¯†é’¥
- âŒ ä¸è¦åˆ†äº« user.cfg æ–‡ä»¶

### 2. èµ„é‡‘ç®¡ç†
- ğŸ’° åˆæœŸä½¿ç”¨å°é¢èµ„é‡‘æµ‹è¯•
- ğŸ’° ä¸è¦æŠ•å…¥å…¨éƒ¨èµ„é‡‘
- ğŸ’° è®¾ç½®æ­¢æŸç­–ç•¥
- ğŸ’° å®šæœŸæå–åˆ©æ¶¦

### 3. é£é™©æ§åˆ¶
- âš ï¸ ç›‘æ§å¸‚åœºæ³¢åŠ¨
- âš ï¸ æ³¨æ„äº¤æ˜“æ‰€ç»´æŠ¤æ—¶é—´
- âš ï¸ å¤‡ä»½æ•°æ®åº“æ–‡ä»¶
- âš ï¸ ä¿æŒç½‘ç»œç¨³å®š

---

## ä¹ã€å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åœæ­¢æœºå™¨äººï¼Ÿ
```bash
# å¦‚æœæ˜¯ç›´æ¥è¿è¡Œ
Ctrl + C

# å¦‚æœæ˜¯Docker
docker-compose down
```

### Q2: å¦‚ä½•ä¿®æ”¹äº¤æ˜“å¸ç§ï¼Ÿ
ç¼–è¾‘ `supported_coin_list` æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªå¸ç§ç¬¦å·ã€‚

### Q3: æœºå™¨äººå¡åœ¨æŸä¸ªå¸ç§æ€ä¹ˆåŠï¼Ÿ
1. æ‰‹åŠ¨åœ¨å¸å®‰å–å‡ºè¯¥å¸ç§
2. ä¿®æ”¹æ•°æ®åº“ `current_coin` è¡¨
3. æˆ–ä½¿ç”¨ `multiple_coins` ç­–ç•¥

### Q4: å›æµ‹é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ
- é¦–æ¬¡è¿è¡Œéœ€è¦ä¸‹è½½å†å²æ•°æ®ï¼Œä¼šæ¯”è¾ƒæ…¢
- ä½¿ç”¨ç¼“å­˜åä¼šå¿«å¾ˆå¤š
- ç¼©çŸ­å›æµ‹æ—¶é—´èŒƒå›´

### Q5: å¦‚ä½•æŸ¥çœ‹æ”¶ç›Šï¼Ÿ
```bash
sqlite3 data/crypto_trading.db
SELECT * FROM coin_value ORDER BY datetime DESC;
```

---

## åã€æ–‡ä»¶ç»“æ„æ€»è§ˆ

```
binance-trade-bot/
â”œâ”€â”€ user.cfg                      # ä¸»é…ç½®æ–‡ä»¶ï¼ˆä½ éœ€è¦åˆ›å»ºï¼‰
â”œâ”€â”€ supported_coin_list           # æ”¯æŒçš„å¸ç§åˆ—è¡¨
â”œâ”€â”€ backtest.py                   # å›æµ‹è„šæœ¬
â”œâ”€â”€ requirements.txt              # Pythonä¾èµ–
â”‚
â”œâ”€â”€ binance_trade_bot/            # æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ __main__.py              # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ crypto_trading.py        # äº¤æ˜“é€»è¾‘
â”‚   â”œâ”€â”€ config.py                # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database.py              # æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ binance_api_manager.py   # APIå°è£…
â”‚   â”œâ”€â”€ auto_trader.py           # äº¤æ˜“åŸºç±»
â”‚   â”œâ”€â”€ strategies/              # ç­–ç•¥ç›®å½•
â”‚   â”‚   â”œâ”€â”€ default_strategy.py
â”‚   â”‚   â”œâ”€â”€ multiple_coins_strategy.py
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â””â”€â”€ models/                  # æ•°æ®æ¨¡å‹
â”‚
â”œâ”€â”€ data/                        # æ•°æ®ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ crypto_trading.db       # ä¸»æ•°æ®åº“
â”‚   â””â”€â”€ backtest_cache.db       # å›æµ‹ç¼“å­˜
â”‚
â”œâ”€â”€ logs/                        # æ—¥å¿—ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ crypto_trading.log
â”‚
â””â”€â”€ config/                      # é€šçŸ¥é…ç½®
    â””â”€â”€ apprise.yml
```

---

## åä¸€ã€ä¸‹ä¸€æ­¥

1. âœ… å®Œæˆé…ç½®æ–‡ä»¶è®¾ç½®
2. âœ… åœ¨æµ‹è¯•ç½‘æµ‹è¯•ï¼ˆtestnet=trueï¼‰
3. âœ… è¿è¡Œå›æµ‹éªŒè¯ç­–ç•¥
4. âœ… å°èµ„é‡‘å®ç›˜æµ‹è¯•
5. âœ… ç›‘æ§ä¸€å‘¨åé€æ­¥å¢åŠ èµ„é‡‘

---

## åäºŒã€è·å–å¸®åŠ©

- GitHub Issues: https://github.com/edeng23/binance-trade-bot/issues
- å®˜æ–¹æ–‡æ¡£: é¡¹ç›®README.md
- å¸å®‰APIæ–‡æ¡£: https://binance-docs.github.io/apidocs/

---

**å…è´£å£°æ˜ï¼š**
åŠ å¯†è´§å¸äº¤æ˜“å­˜åœ¨é£é™©ï¼Œè‡ªåŠ¨äº¤æ˜“æœºå™¨äººå¯èƒ½å¯¼è‡´èµ„é‡‘æŸå¤±ã€‚è¯·ä»”ç»†æµ‹è¯•å¹¶ç†è§£ä»£ç é€»è¾‘åå†ä½¿ç”¨çœŸå®èµ„é‡‘ã€‚æœ¬æŒ‡å—ä»…ä¾›å­¦ä¹ å‚è€ƒã€‚
